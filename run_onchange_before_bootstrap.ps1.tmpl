{{ if eq .chezmoi.os "windows" -}}
# Function to print formatted messages with green bold arrow and bold text
function Write-Message {
    param([string]$Message)
    Write-Host -NoNewline -ForegroundColor Green "$([char]27)[1m==>$([char]27)[0m "
    Write-Host "$([char]27)[1m$Message$([char]27)[0m"
}

# Function to print sub-messages with blue arrow
function Write-SubMessage {
    param([string]$Message)
    Write-Host -NoNewline "  "
    Write-Host -NoNewline -ForegroundColor Blue "$([char]27)[1m==>$([char]27)[0m "
    Write-Host "$Message"
}

Write-Message "Starting bootstrap for Windows..."

# Install packages via winget (excluding btop and zellij - not supported on Windows)
Write-Message "Installing packages via winget..."
winget install microsoft.powershell Git.Git starship neovim junegunn.fzf lazygit OpenJS.NodeJS peazip yazi sharkdp.fd ripgrep python3 zoxide eza-community.eza dandavison.delta alexx2000.DoubleCommander Microsoft.Sysinternals.Suite

# Install PowerShell modules
Write-Message "Installing PowerShell modules..."
$env:Path = [System.Environment]::GetEnvironmentVariable("Path","Machine") + ";" + [System.Environment]::GetEnvironmentVariable("Path","User")
pwsh -c "Install-Module PSFzf,Microsoft.WinGet.Client,Microsoft.Powershell.ConsoleGuiTools -Force"

Write-Message "Bootstrap complete!"
{{ end -}}
